<% border_class = (level || 0) > 0 ? 'border-l border-dashed border-gray-300 pl-4' : '' %>
<% if node[:children].present? %>
  <li class="mb-0.5" role="treeitem" aria-expanded="true">
    <div class="<%= border_class %>">
      <div class="flex items-center gap-2 mb-1 p-1.5 hover:bg-gray-50 rounded-md transition-colors">
        <%= render partial: 'servactory/web/shared/folder_icon' %>
        <span class="text-sm font-semibold text-gray-800"><%= node[:name] %></span>
      </div>
      <ul role="group">
        <% node[:children].each do |child| %>
          <%= render partial: 'servactory/web/services/service_node', locals: { node: child, level: (level || 0) + 1 } %>
        <% end %>
      </ul>
    </div>
  </li>
<% else %>
  <li class="mb-0.5" role="treeitem">
    <div class="<%= border_class %>">
      <div class="flex items-center gap-2 p-1 hover:bg-gray-50 rounded-md transition-colors">
        <%= render partial: 'servactory/web/shared/file_icon' %>
        <%= link_to node[:name], Servactory::Web::Engine.routes.url_helpers.service_path(node[:path]), class: "text-sm text-gray-700 hover:text-blue-600 transition-colors", aria: { label: "View service: #{node[:name]}" } %>
      </div>
    </div>
  </li>
<% end %>
